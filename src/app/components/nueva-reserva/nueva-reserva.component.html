<div class="nueva-reserva">
    <h2>Nueva Reserva</h2>

    <!-- MENÚ DESPLEGABLE DE NEGOCIOS -->
    <div class="business-dropdown-container">
        <label for="businessSelect">Seleccione un negocio:</label>
        <select id="businessSelect" #businessSelect (change)="onBusinessSelect(businessSelect.value)">
            <option value="">Seleccione un negocio</option>
            <option *ngFor="let business of businesses" [value]="business.id_negocio">
                {{ business.nombre }} - {{ business.direccion }}
            </option>
        </select>
    </div>

    <!-- Sección para cuando no hay negocio seleccionado -->
    <div *ngIf="!selectedBusiness" class="empty-state">
        <p>Selecciona un negocio para ver su ubicación y realizar una reserva.</p>
        <img src="assets/map-placeholder.svg" alt="Mapa de referencia">
    </div>

    <!-- Contenedor del mapa y formulario -->
    <div *ngIf="selectedBusiness" class="reservation-container">
        <!-- MAPA -->
        <div class="map-section">
            <google-map class="map-canvas" [center]="center" [zoom]="zoom">
                <map-marker
                    [position]="parseCoordinates(selectedBusiness.coordenadas)"
                    (mapClick)="onMarkerClick(selectedBusiness)">
                </map-marker>
            </google-map>
        </div>

        <!-- FORMULARIO DE RESERVA -->
        <div class="reservation-form">
            <h3>Reserva en: {{ selectedBusiness.nombre }}</h3>
            <form [formGroup]="reservationForm" (ngSubmit)="onSubmit()">
                <input type="hidden" formControlName="businessId">

                <div class="form-group">
                    <label for="date">Fecha:</label>
                    <input type="date" id="date" formControlName="date">
                </div>

                <div class="form-group">
                    <label for="time">Hora:</label>
                    <input type="time" id="time" formControlName="time">
                </div>

                <div class="form-group">
                    <label for="serviceId">Servicio:</label>
                    <select id="serviceId" formControlName="serviceId">
                        <option value="">Seleccione un servicio</option>
                        <option *ngFor="let service of services" [value]="service.id_servicio">
                            {{ service.nombre }}
                        </option>
                    </select>
                </div>

                <button type="submit" class="btn submit-btn" [disabled]="reservationForm.invalid">
                    Crear Reserva
                </button>
            </form>
        </div>
    </div>
</div>
